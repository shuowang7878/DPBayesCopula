% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DPCopula_correlaiton.R
\name{bayes_noiseaware}
\alias{bayes_noiseaware}
\title{Bayesian noise-aware differentially private Gaussian copula (Bayes-NA)}
\usage{
bayes_noiseaware(
  data,
  epsilon,
  iter_sampling = 100,
  iter_warmup = 100,
  seed = NULL,
  chains = 1,
  cores = 1
)
}
\arguments{
\item{data}{A numeric data.frame or matrix (rows = observations, columns = variables).
No missing values allowed.}

\item{epsilon}{Global privacy budget. The per-pair budget is
\code{epsilon / choose(p, 2)}.}

\item{iter_sampling}{Number of post-warmup sampling iterations. Defaults to 100.}

\item{iter_warmup}{Number of warmup iterations. Defaults to 100.}

\item{seed}{Optional random seed for reproducibility (affects DP noise).}

\item{chains}{Number of Stan MCMC chains (default 1).}

\item{cores}{Number of CPU cores for Stan (default 1).}
}
\value{
A list containing:
\describe{
\item{mean}{Posterior mean correlation matrix, i.e. estimated
differentially private \eqn{p \times p} correlation matrix.}
\item{sd}{Posterior standard deviation matrix.}
\item{ci_lower}{2.5\\% elementwise posterior quantiles.}
\item{ci_upper}{97.5\\% elementwise posterior quantiles.}
\item{samples}{Posterior samples of the correlation matrix,
an array of dimension \code{(iter_sampling * chains) x p x p}.}
\item{dp}{A list with differential privacy metadata, including
\code{epsilon}, \code{epsilon_per_pair}, \code{sensitivity}[].}
}
}
\description{
This function implements the Bayesian noise-aware (Bayes-NA) estimator for
a Gaussian copula correlation matrix under differential privacy. It first
constructs differentially private pairwise highâ€“high counts based on
median thresholds, then fits a Bayesian latent Gaussian model in Stan to
recover the correlation matrix.
}
\details{
For each pair \eqn{(i, j)}, the sufficient statistic is
\deqn{
  T_{ij} = \sum_{s=1}^n \mathbf{1}\{X_{s,i} \ge \mathrm{med}(X_i),
                                   X_{s,j} \ge \mathrm{med}(X_j)\},
}
where \eqn{\mathrm{med}(X_i)} is the sample median of column \eqn{i}.
Ties at the median are included in the "\eqn{\ge} median" group.
}
\examples{
\dontrun{
  set.seed(123)
  X <- matrix(rnorm(300), ncol = 3)
  fit <- bayes_noiseaware(X, epsilon = 1, iter_sampling = 500, iter_warmup = 500)
  fit$mean
}

}
